<script type="text/javascript"
    src="https://dx.mountain.com/spx?dxver=4.0.0&amp;shaid=35018&amp;tdr=&amp;plh=https%3A%2F%2Fwww.truecar.com%2F&amp;cb=84437223920397900term=value">
</script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/6034-be8d17b0e59f5fde.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/4003-28d5a45b06f824e7.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/1107-5f58e27db8408690.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/5896-8aa3224f6e6f2801.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/9701-62aaa014cc03d2b7.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/3131-9863e1a6d0b25395.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/pages/%5Bextra%5D/sell-your-car-c9329dafe1d559c5.js">
</script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/4547-1e4ae236754b26a6.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/5629-7c553184178703e3.js"></script>
<script
    src="https://consumer.tcimg.net/assets/_next/static/chunks/pages/%5Bextra%5D/shop/%5BshopType%5D-04867705b5bb33c2.js">
</script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/2303-9fa65f2056df8262.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/1637-af03daee06935e10.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/6702-2568713927472fec.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/945-059afe009b506390.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/8263-13d74881a86e3113.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/8232-187c3553f5996e99.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/5693-087b2aee08eec699.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/4439-8823de39f348a03c.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/3985-dc4a4b440fc6c8f3.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/4688-ae3b9b55eebc44a3.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/162-18d4cbd5c8741222.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/1270-ed3c44317e9c72f2.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/1850-ea97245557f3d63f.js"></script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/8885-11c7bac8fa3dc4f9.js"></script>
<script
    src="https://consumer.tcimg.net/assets/_next/static/chunks/pages/%5Bextra%5D/rewrites/marketplace/challenger/%5Bcondition%5D/listings/%5B%5B...splat%5D%5D-55f4e82592a2ddfb.js">
</script>
<script src="https://consumer.tcimg.net/assets/_next/static/chunks/2782-590744d639e5db80.js"></script>
<script type="text/javascript"
    src="https://px.mountain.com/st?ga_tracking_id=UA-81859011-3&amp;shpt=TrueCar%20%7C%20New%20%26%20Used%20Cars%20for%20Sale%20%7C%20Car%20Pricing%20%26%20Reviews&amp;ga_info=%7B%22status%22%3A%22FAILED%22%2C%22ga_tracking_id%22%3A%22UA-81859011-3%22%2C%22shpt%22%3A%22TrueCar%20%7C%20New%20%26%20Used%20Cars%20for%20Sale%20%7C%20Car%20Pricing%20%26%20Reviews%22%2C%22dcm_cid%22%3A%221413160162.1722798316%22%2C%22execution_workflow%22%3A%7B%22iteration%22%3A29%2C%22getClientIdByGA%22%3A%22FAILED%22%2C%22getClientIdByTracker%22%3A%22FAILED%22%2C%22getClientIdByGAData%22%3A%22FAILED%22%2C%22getClientIdByCookie%22%3A%22FAILED%22%2C%22shpt%22%3A%22OK%22%2C%22dcm_cid%22%3A%22OK%22%7D%2C%22message%22%3A%22Could%20not%20evaluate%20some%20of%20the%20GA%20parameters%20due%20to%20timeout%20reached%20(3000ms).%20Check%20the%20execution_workflow%20for%20details.%22%7D&amp;dcm_cid=1413160162.1722798316&amp;available_ga=%5B%7B%22id%22%3A%22G-J3VWL05G5K%22%2C%22sess_id%22%3A%221722798316%22%7D%5D&amp;hardcoded_ga=UA-81859011-3&amp;dxver=4.0.0&amp;shaid=35018&amp;plh=https%3A%2F%2Fwww.truecar.com%2F&amp;cb=84437223920397900term%3Dvalue&amp;shoid=TC_1413160162.1722798316&amp;shpn=2025 BMW 5&nbsp;Series&amp;shps=2025bmw5series&amp;shpc=&amp;shadditional=googletagmanager%3Dtrue%2Cga4%3Dtrue%2Ctealium%3Dtrue">
</script>

 <!-- Jquery Ui Js File -->
 <script src="{{asset('novaride/js/jquery-ui.js')}}"></script>
 <!-- Bootstrap js file -->
 <script src="{{asset('novaride/js/bootstrap.min.js')}}"></script>
 <!-- Validator js file -->
 <script src="{{asset('novaride/js/validator.min.js')}}"></script>
 <!-- SlickNav js file -->
 <script src="{{asset('novaride/js/jquery.slicknav.js')}}"></script>
 <!-- Swiper js file -->
 <script src="{{asset('novaride/js/swiper-bundle.min.js')}}"></script>
 <!-- Counter js file -->
 <script src="{{asset('novaride/js/jquery.waypoints.min.js')}}"></script>
 <script src="{{asset('novaride/js/jquery.counterup.min.js')}}"></script>
 <!-- Magnific js file -->
 <script src="{{asset('novaride/js/jquery.magnific-popup.min.js')}}"></script>
 <!-- SmoothScroll -->
 <script src="{{asset('novaride/js/SmoothScroll.js')}}"></script>
 <!-- Parallax js -->
 <script src="{{asset('novaride/js/parallaxie.js')}}"></script>
 <!-- MagicCursor js file -->
 <script src="{{asset('novaride/js/gsap.min.js')}}"></script>
 <script src="{{asset('novaride/js/magiccursor.js')}}"></script>
 <!-- Text Effect js file -->
 <script src="{{asset('novaride/js/SplitText.js')}}"></script>
 <script src="{{asset('novaride/js/ScrollTrigger.min.js')}}"></script>
 <!-- YTPlayer js File -->
 <script src="{{asset('novaride/js/jquery.mb.YTPlayer.min.js')}}"></script>
 <!-- Wow js file -->
 <script src="{{asset('novaride/js/wow.js')}}"></script>
 <!-- Main Custom js file -->
 <script src="{{asset('novaride/js/function.js')}}"></script>
<script type="text/javascript">
    !(function() {
        var e =
            "(function(){try {window.mntn = {is_viewable_verified_visit:'false', is_cross_device:'false', creative_group_id:'', creative_group_name:'', impression_epoch_micros:'', visit_tracking:''};} catch (e) {}})();",
            t = document.createElement("script");
        (t.type = "text/javascript"),
        document.createElement("canvas").getContext ?
            t.innerText ?
            (t.innerText = e) :
            (t.textContent = e) :
            (t.text = g),
            (e = document.getElementsByTagName("script")),
            (e = Number(e.length) - 1),
            (e =
                document.getElementsByTagName("script")[e]).parentNode.insertBefore(
                t,
                e
            );
    })();
</script>
<script type="text/javascript">
    (function() {
        try {
            window.mntn = {
                is_viewable_verified_visit: "false",
                is_cross_device: "false",
                creative_group_id: "",
                creative_group_name: "",
                impression_epoch_micros: "",
                visit_tracking: "",
            };
        } catch (e) {}
    })();
</script>
<script
    src="https://consumer.tcimg.net/assets/_next/static/chunks/pages/%5Bextra%5D/rewrites/electric-c93ae43f0bc4ceeb.js">
</script>

<script>
    $(document).ready(function() {
        $('.nav-dropdown-btn').click(function() {
            $('.dropdown ul').css('display', 'none');
            var $nextUl = $(this).next('ul');
            if ($nextUl.attr('display') == 'block') {
                $nextUl.css('display', 'none');
                $nextUl.attr('display', 'none');
            } else {
                $nextUl.css('display', 'block');
                $nextUl.attr('display', 'block');
            }
        });
        $('#buyingPowerModuleTradeInMd').change(function() {
            if ($(this).prop('checked')) {
                $('#tradeInAmount').show();
            } else {
                $('#tradeInAmount').hide();
            }
        });

        $('.switch').click(function() {
            $(this).attr('data-selected', true);
            $(this).prev('.switch').removeAttr('data-selected');
            $(this).next('.switch').removeAttr('data-selected');
        })

        $('.seeMorebtn').click(function() {
            $('#seeMoreSection').css('display', 'none');
            $('#seeLessSection').css('display', 'block');
        })
        $('.seeLessbtn').click(function() {
            $('#seeMoreSection').css('display', 'block');
            $('#seeLessSection').css('display', 'none');
        })


        $('button[role="tab"]').click(function() {
            let panelId = $(this).attr('aria-controls');
            $('#' + panelId).removeAttr('hidden');
            $('#' + panelId).siblings('div[role="tabpanel"]').attr('hidden', true);
            $(this).attr('aria-selected', 'true').attr('tabindex', '0').attr('data-selected', true);
            $(this).siblings('button[role="tab"]').attr('aria-selected', 'false').attr('tabindex', '-1')
                .removeAttr('data-selected');
        });


        $('button[data-test="seeMoreButton"]').click(function() {
            $(this).parent('div[data-test="seeMoreLinkContainer"]').css('display', 'none');
            $(this).parent('div').next('div[data-test="seeLessLinkContainer"]').css('display', 'block');
            $(this).parent('div').prev('div[data-test="seeMoreBody"]').css({
                'overflow': 'unset',
                'max-height': 'unset',
            });
        });

        $('button[data-test="seeLessButton"]').click(function() {
            $(this).parent('div').prev('div[data-test="seeMoreLinkContainer"]').css('display', 'block');
            $(this).parent('div[data-test="seeLessLinkContainer"]').css('display', 'none');
            $(this).parent('div').prev('div').prev('div[data-test="seeMoreBody"]').css({
                'overflow': 'hidden',
                'max-height': '9em',
            });
        });

        $('.expandable-list-item-button').click(function() {
            let isExpanded = $(this).attr('aria-expanded') === 'true';
            $(this).attr('aria-expanded', !isExpanded);

            let content = $(this).next('.expandable-list-item-collapse');
            content.slideToggle();

            let icon = $(this).find('svg use');
            if (isExpanded) {
                icon.attr('href', '#keyboard_arrow_down');
            } else {
                icon.attr('href', '#keyboard_arrow_up');
            }
        });

        $('a[data-test="navigationTab"]').click(function() {
            $('[data-test="navigationTab"]').removeClass('tab-active');
            $(this).addClass('tab-active');
        })

        $('#buyingPowerTradeIn').change(function() {
            if ($(this).prop('checked')) {
                $('div[data-test="buyingPowerCalculatorInputsTradeInValue"]').removeClass('hidden');
            } else {
                $('div[data-test="buyingPowerCalculatorInputsTradeInValue"]').addClass('hidden');
            }
        })
    });

    $(document).ready(function() {
        // Variables for the carousel
        var $carousel = $('[data-test="rankingCategoriesCarousel"]');
        var $slideContainer = $carousel.find('ul[role="menubar"]');
        var $slides = $slideContainer.children('li');
        var slideCount = $slides.length;
        var currentIndex = 0;

        // Function to go to the specific slide
        function goToSlide(index) {
            if (index < 0 || index >= slideCount) {
                return;
            }
            var slideWidth = $slides.eq(0).outerWidth(true);
            $slideContainer.css('transform', 'translateX(' + (-slideWidth * index) + 'px)');
            currentIndex = index;
            updateArrows();
        }

        function updateArrows() {
            $carousel.find('[data-test="carouselArrowPrev"]').prop('disabled', currentIndex === 0);
            $carousel.find('[data-test="carouselArrowNext"]').prop('disabled', currentIndex === slideCount - 1);
        }

        $carousel.find('[data-test="carouselArrowPrev"]').click(function() {
            goToSlide(currentIndex - 1);
        });

        $carousel.find('[data-test="carouselArrowNext"]').click(function() {
            goToSlide(currentIndex + 1);
        });

        goToSlide(0);
    });


    $(document).ready(function() {
        var $carousel = $('.rankingsRecommendationCarousel');
        var $slideContainer = $carousel.find('ul[data-test="carouselSlideContainer"]');
        var $slides = $slideContainer.children('li');
        var $dots = $carousel.find('ul[data-test="carouselDots"]').children('li');
        var totalSlides = $slides.length;
        var currentIndex = 0;

        function goToSlide(index) {
            if (index < 0 || index >= totalSlides) {
                return;
            }

            var slideWidth = $slides.eq(0).outerWidth(true);
            $slideContainer.css('transform', 'translateX(' + (-slideWidth * index) + 'px)');

            $dots.removeClass('bg-black').addClass('bg-[color:var(--gray-200)]');
            $dots.eq(index).removeClass('bg-[color:var(--gray-200)]').addClass('bg-black');

            $carousel.find('[data-test="carouselArrowPrev"]').prop('disabled', index === 0);
            $carousel.find('[data-test="carouselArrowNext"]').prop('disabled', index === totalSlides - 1);

            currentIndex = index;
        }

        $carousel.find('[data-test="carouselArrowPrev"]').click(function() {
            goToSlide(currentIndex - 1);
        });

        $carousel.find('[data-test="carouselArrowNext"]').click(function() {
            goToSlide(currentIndex + 1);
        });

        $dots.click(function() {
            var index = $(this).index();
            goToSlide(index);
        });

        goToSlide(0);
    });

    $(document).ready(function() {
        var $inputLeft = $('#error-38_from');
        var $inputRight = $('#error-38_to');
        var $outputLeft = $('#39');
        var $outputRight = $('#40');
        var $progress = $('.bg-blue-900'); // Adjust this selector based on your actual progress bar

        function updateSlider() {
            var minValue = parseInt($inputLeft.val(), 10);
            var maxValue = parseInt($inputRight.val(), 10);

            // Ensure sliders don't cross each other
            if (minValue > maxValue) {
                $inputLeft.val(maxValue);
                minValue = maxValue;
            }

            // Update output values
            $outputLeft.val('$' + minValue.toLocaleString());
            $outputRight.val('$' + maxValue.toLocaleString());

            // Update progress bar width
            var percentage = ((maxValue - minValue) / ($inputRight.attr('max') - $inputRight.attr('min'))) *
            100;
            $progress.css('width', percentage + '%');
        }

        // Initialize
        updateSlider();

        // Bind change event
        $inputLeft.add($inputRight).on('input change', function() {
            updateSlider();
        });
    });

    //Affordable Calculator

    $(document).ready(function () {
    // Cache all the range inputs and corresponding elements
    var rangeInputs = [
        {
            rangeInput: $('#error-69'),
            progressBar: $('#error-69').closest('div').find('.bg-blue-900'),
            sliderIndicator: $('#error-69').closest('div').find('[data-test="sliderIndicatorRight"]'),
            inputField: $('#68')
        },
        {
            rangeInput: $('#error-72'),
            progressBar: $('#error-72').closest('div').find('.bg-blue-900').first(),
            sliderIndicator: $('#error-72').closest('div').find('[data-test="sliderIndicatorRight"]'),
            dots: $('#error-72').closest('div').find('.absolute.h-[8px].w-[8px]')
        },
        {
            rangeInput: $('#error-75'),
            progressBar: $('#error-75').closest('div').find('.bg-blue-900').first(),
            sliderIndicator: $('#error-75').closest('div').find('[data-test="sliderIndicatorRight"]'),
            inputField: $('#74'),
            formatCurrency: true
        }
    ];

    // Function to update progress bar, slider indicator, and optional input field or dots
    function updateSlider(rangeData) {
        let value = rangeData.rangeInput.val();
        let min = rangeData.rangeInput.attr('min');
        let max = rangeData.rangeInput.attr('max');
        let percentage = ((value - min) / (max - min)) * 100;

        // Update progress bar and slider indicator
        rangeData.progressBar.css('right', (100 - percentage) + '%');
        rangeData.sliderIndicator.css('left', percentage + '%');

        // Update input field if it exists
        if (rangeData.inputField) {
            let formattedValue = rangeData.formatCurrency ? "$" + Number(value).toLocaleString() : '$' + parseInt(value).toLocaleString();
            rangeData.inputField.val(formattedValue);
        }

        // Update dot colors if they exist
        if (rangeData.dots) {
            rangeData.dots.each(function (index) {
                if (index < value) {
                    $(this).removeClass('bg-[color:var(--gray-300)]').addClass('bg-blue-900');
                } else {
                    $(this).removeClass('bg-blue-900').addClass('bg-[color:var(--gray-300)]');
                }
            });
        }
    }

    // Initialize all sliders
    rangeInputs.forEach(function (rangeData) {
        updateSlider(rangeData);

        // Event listener for range input changes
        rangeData.rangeInput.on('input', function () {
            updateSlider(rangeData);
        });

        // Event listeners for dragging the slider thumb
        rangeData.rangeInput.on('mousedown touchstart', function () {
            $(this).on('mousemove touchmove', function () {
                updateSlider(rangeData);
            });
        }).on('mouseup touchend', function () {
            $(this).off('mousemove touchmove');
        });

        // Event listener for input field changes (for trade-in value)
        if (rangeData.inputField && rangeData.formatCurrency) {
            rangeData.inputField.on('input', function () {
                let value = $(this).val().replace(/\D/g, '');  // Remove non-numeric characters
                if (value === "") value = "0";  // If input is empty, set value to 0
                rangeData.rangeInput.val(value);  // Update the range input value
                updateSlider(rangeData);  // Update the slider
            });
        }
    });
});


$(document).ready(function () {
    function updateSlider($rangeInput, $progressBar, $sliderIndicator, $inputField) {
        let value = $rangeInput.val();
        let min = $rangeInput.attr('min');
        let max = $rangeInput.attr('max');

        let percentage = ((value - min) / (max - min)) * 100;

        $progressBar.css('right', (100 - percentage) + '%');
        $sliderIndicator.css('left', percentage + '%');
        $inputField.val('$' + parseInt(value).toLocaleString());
    }

    function initSlider(rangeSelector, inputSelector) {
        let $rangeInput = $(rangeSelector);
        let $progressBar = $rangeInput.closest('div').find('.bg-blue-900');
        let $sliderIndicator = $rangeInput.closest('div').find('[data-test="sliderIndicatorRight"]');
        let $inputField = $(inputSelector);

        updateSlider($rangeInput, $progressBar, $sliderIndicator, $inputField);

        $rangeInput.on('input', function () {
            updateSlider($rangeInput, $progressBar, $sliderIndicator, $inputField);
        });

        $rangeInput.on('mousedown touchstart', function () {
            $(this).on('mousemove touchmove', function () {
                updateSlider($rangeInput, $progressBar, $sliderIndicator, $inputField);
            });
        }).on('mouseup touchend', function () {
            $(this).off('mousemove touchmove');
        });

        $inputField.on('input', function () {
            let value = $(this).val().replace(/\D/g, '');
            if (value === "") value = "0";
            $rangeInput.val(value);
            updateSlider($rangeInput, $progressBar, $sliderIndicator, $inputField);
        });
    }

    // Initialize the sliders
    initSlider('#error-67', '#66');
});


$(document).ready(function () {
    // Function to initialize and handle range input sliders
    function initRangeSlider(rangeInputId, progressBarSelector, sliderIndicatorSelector, inputFieldSelector, dotsSelector) {
        let $rangeInput = $(rangeInputId);
        let $progressBar = $rangeInput.closest('div').find(progressBarSelector).first();
        let $sliderIndicator = $rangeInput.closest('div').find(sliderIndicatorSelector);
        let $inputField = $(inputFieldSelector);
        let $dots = dotsSelector ? $rangeInput.closest('div').find(dotsSelector) : null;

        // Function to update the progress bar, slider indicator, input field, and dots
        function updateProgressBar() {
            let value = $rangeInput.val();
            let min = $rangeInput.attr('min');
            let max = $rangeInput.attr('max');
            let percentage = ((value - min) / (max - min)) * 100;

            $progressBar.css('right', (100 - percentage) + '%');
            $sliderIndicator.css('left', percentage + '%');

            if ($inputField.length) {
                $inputField.val('$' + parseInt(value).toLocaleString());
            }

            if ($dots) {
                $dots.each(function (index) {
                    if (index < value) {
                        $(this).removeClass('bg-[color:var(--gray-300)]').addClass('bg-blue-900');
                    } else {
                        $(this).removeClass('bg-blue-900').addClass('bg-[color:var(--gray-300)]');
                    }
                });
            }
        }

        updateProgressBar();

        $rangeInput.on('input', function () {
            updateProgressBar();
        });

        $rangeInput.on('mousedown touchstart', function () {
            $(this).on('mousemove touchmove', function () {
                updateProgressBar();
            });
        }).on('mouseup touchend', function () {
            $(this).off('mousemove touchmove');
        });

        if ($inputField.length) {
            $inputField.on('input', function () {
                let value = $(this).val().replace(/\D/g, '');
                if (value === "") value = "0";
                $rangeInput.val(value);
                updateProgressBar();
            });
        }
    }

    // Initialize all range sliders
    initRangeSlider('#error-67', '.bg-blue-900', '[data-test="sliderIndicatorRight"]', '#66');
    initRangeSlider('#error-69', '.bg-blue-900', '[data-test="sliderIndicatorRight"]', '#68');
    initRangeSlider('#error-72', '.bg-blue-900', '[data-test="sliderIndicatorRight"]', null, '.absolute.h-[8px].w-[8px]');
    initRangeSlider('#error-75', '.bg-blue-900', '[data-test="sliderIndicatorRight"]', '#74');
});


$(document).ready(function() {
    // Handle the main category toggle
    $('.theme-light h3 button').click(function() {
        // Toggle the 'collapse' class for the associated section
        $(this).closest('h3').next('.collapse').slideToggle(300);

        // Rotate the arrow icon
        $(this).find('.icon').toggleClass('rotate');
    });

    // Handle the expandable card toggle
    $('.expandable-card-title').click(function() {
        // Toggle the expanded state
        let $card = $(this).closest('.expandable-card');
        let $content = $card.find('.expandable-card-collapse');
        let isExpanded = $(this).attr('aria-expanded') === 'true';

        // Toggle the content visibility
        $content.slideToggle(300);

        // Update the aria-expanded attribute
        $(this).attr('aria-expanded', !isExpanded);

        // Rotate the arrow icon
        $(this).find('.expandable-card-icon').toggleClass('rotate');
    });
});
</script>
@stack('scripts')
